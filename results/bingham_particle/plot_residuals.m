% Script for plotting the residuals in the Uzawa iterations
% Author: Vidar Stiernstr√∂m, 2025
% Contact: vidarsti@kth.se

alg = 'RS03'; % Algorith used in solver
load(alg + "/residuals_r1000.mat")

semilogy( iter, error_u, '-',...
          iter, error_q, '-',...
          iter, error_gamma,'-',...
          iter, tol*ones(length(iter),1), 'k--',...
          'LineWidth', 2);
if strcmp(alg,'RS03')
    legend( '$\|u^{n+1} - u^{n}\|_{\Omega}$',...
            '$\|q^{n+1} - q^{n}\|_{\Omega}$',...
            '$\|\dot{D}(u^{n+1}) - q^{n+1}\|_{\Omega}$',...
            'tolerance',...
            'Interpreter','latex');
else
    legend( '$\|u^{n+1} - u^{n}\|_{\Omega}$',...
            '$\|q^{n+1} - q^{n}\|_{\Omega}$',...
            '$\|\dot{\gamma}(u^{n+1}) - q^{n+1}\|_{\Omega}$',...
            'tolerance',...
            'Interpreter','latex');
end

ylabel('Residual error','Interpreter','latex');
xlabel('Iteration','Interpreter','latex');